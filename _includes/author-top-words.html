{% assign data = site.data.yazarlar[include.author_slug] %}
{% if data == nil %}
  <p>Data not found for <code>{{ include.author_slug }}</code>.</p>
{% else %}
  {% assign freq = data.total_stats %}
  <div id="chart-{{ include.author_slug }}" style="width:100%;height:520px"></div>
  <script>
    (function() {
      const elId = "chart-{{ include.author_slug }}";
      const raw = {{ freq | jsonify }};
      const hideStop = {{ include.hide_stopwords | default: false }};
      const stop = new Set(["ve","de","da","bu","bir","mi","mı","mu","mü","ki","ile","için","çok","ama","fakat","ya","ne","o","hem","her","gibi","şu","şey"]);

      let arr = Object.entries(raw);
      if (hideStop) arr = arr.filter(([w]) => !stop.has(w));
      arr.sort((a,b) => b[1] - a[1]).splice({{ include.top_n | default: 30 }});

      const words = arr.map(([w]) => w);
      const counts = arr.map(([,c]) => c);
      Plotly.newPlot(elId, [{ x: counts, y: words, type: "bar", orientation: "h" }],
        { margin:{l:140,r:10,t:10,b:40}, xaxis:{title:"Frekans"}, yaxis:{automargin:true} },
        { displayModeBar:false, responsive:true });
    })();
  </script>
{% endif %}
